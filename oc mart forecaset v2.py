import pandas as pd
import re
from io import StringIO
from statsmodels.tsa.holtwinters import ExponentialSmoothing

# The raw data string you provided
data_string = """
CityJan-2020Feb-2020Mar-2020Apr-2020May-2020Jun-2020Jul-2020Aug-2020Sep-2020Oct-2020Nov-2020Dec-2020Jan-2021Feb-2021Mar-2021Apr-2021May-2021Jun-2021Jul-2021Aug-2021Sep-2021May-2021Jun-2021Jul-2021Aug-2021Sep-2021Oct-2021Nov-2021Dec-2021Oct-2021AveOct-2021Nov-2021Dec-2021Jan-2022Feb-2022Mar-2022Apr-2022May-2022Jun-2022Jul-2022Aug-2022Sep-2022Oct-2022Nov-2022Dec-2022Jan-2023Feb-2023Mar-2023Apr-2023May-2023Jun-2023Jul-2023Aug-2023Sep-2023Oct-2023Nov-2023Dec-2023Jan-2024Feb-2024Mar-2024Apr-2024May-2024Jun-2024Jul-2024Aug-2024Sep-2024Oct-2024Nov-2024Dec-2024Jan-2025Feb-2025Mar-2025Apr-2025May-2025Jun-2025Jul-2025Aug-2025Sep-2025Oct-2025Nov-2025Dec-2025
Alor Setar0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.6%0.5%0.1%0.1%0.1%0.1%0.3%0.2%0.3%0.3%0.6%0.6%0.6%0.3%0.3%0.3%0.3%0.3%0.3%0.8%0.8%0.5%0.6%0.5%0.5%0.7%0.8%0.5%0.4%0.4%0.5%0.6%0.7%0.8%0.9%0.7%0.8%0.7%0.8%0.6%0.6%0.6%0.7%0.9%1.0%0.9%0.9%0.9%0.7%0.8%0.7%0.7%0.8%0.7%0.7%0.8%0.9%0.8%0.8%0.8%1.0%0.8%1.0%1.0%0.8%0.8%0.7%0.7%0.3%0.6%0.6%0.5%
Batu Pahat0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.0%0.1%0.1%0.0%0.0%0.0%0.1%0.1%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.2%0.1%0.1%0.1%0.1%0.1%0.2%0.1%0.1%0.1%0.2%0.3%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.1%0.1%0.1%0.2%0.2%0.1%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.1%0.1%0.1%0.1%
Bintulu0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.1%0.0%0.0%0.0%0.0%0.0%0.1%0.1%0.1%0.1%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.2%0.2%0.2%0.3%0.2%0.1%0.1%0.2%0.2%0.1%0.1%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.3%0.3%0.2%0.2%0.2%0.2%0.2%0.2%0.3%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.3%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.1%0.2%0.2%0.1%
Ipoh6.8%7.5%7.9%6.5%7.2%7.4%6.0%6.8%7.7%4.1%4.7%5.3%4.8%6.7%6.8%6.6%5.7%5.7%7.1%7.1%5.9%5.9%5.9%5.9%5.9%5.9%6.2%8.5%6.0%6.3%6.0%6.1%7.5%8.6%8.6%8.7%11.0%10.1%9.1%9.8%9.5%10.1%10.0%9.6%9.1%8.9%9.1%8.5%8.1%8.1%7.8%8.1%8.3%8.3%8.2%8.0%8.3%8.0%8.8%10.1%9.3%8.6%7.9%7.9%7.7%7.4%7.3%7.9%7.3%7.9%7.7%7.0%7.1%6.9%7.1%9.3%8.0%8.0%8.0%
Johor Bahru13.8%15.2%18.5%18.6%21.7%20.1%19.0%18.5%21.3%29.0%30.2%28.5%26.9%28.8%26.3%28.6%30.6%33.3%26.2%26.2%28.6%28.6%28.6%28.6%28.6%28.6%28.3%34.4%31.0%31.2%34.6%36.0%34.6%32.8%36.4%35.1%36.1%35.7%34.8%34.8%34.7%33.4%33.6%32.3%33.8%33.7%32.0%34.0%34.7%35.0%35.7%35.4%35.8%35.7%35.1%34.9%33.9%35.4%31.9%33.2%33.9%34.7%36.0%35.1%34.8%34.0%33.1%31.5%32.7%30.7%29.5%32.5%33.4%33.8%33.6%36.4%33.4%33.4%33.7%
Kangar0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.1%0.0%0.0%0.1%0.1%0.0%0.0%0.0%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.0%0.1%0.1%0.1%0.0%0.0%0.0%0.0%
Kemaman0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.1%0.1%0.1%0.0%0.1%0.1%0.0%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.2%0.2%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.2%0.1%0.1%0.2%0.1%0.0%0.1%0.1%0.1%
Kluang0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.2%0.0%0.0%0.0%0.0%0.0%0.1%0.1%0.1%0.1%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.2%0.2%0.1%0.1%0.1%0.1%0.1%0.3%0.1%0.1%0.1%0.2%0.2%0.2%0.2%0.3%0.3%0.3%0.3%0.3%0.2%0.2%0.2%0.2%0.1%0.1%0.1%0.1%0.2%0.1%0.2%0.1%0.1%0.1%0.1%0.1%0.1%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.3%0.3%0.3%0.2%0.2%0.1%0.1%0.1%0.1%
Kota Bharu0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.6%0.7%0.0%0.1%0.1%0.1%0.1%0.4%0.7%0.9%1.1%0.6%0.6%0.4%0.4%0.4%0.4%0.4%0.4%1.4%0.6%1.2%1.2%1.0%1.0%1.1%1.3%0.8%0.8%0.8%0.9%0.7%0.7%0.7%0.7%0.7%0.7%0.7%0.7%0.9%0.6%0.7%0.6%0.6%0.6%0.5%0.6%0.5%0.5%0.5%0.5%0.6%0.5%0.5%0.7%0.6%0.6%0.6%0.6%1.7%0.7%0.6%0.7%0.7%0.6%0.7%0.7%0.6%0.3%0.4%0.4%0.4%
Kota Kinabalu19.1%15.6%14.8%15.0%13.0%14.3%27.7%20.8%18.0%22.6%18.6%18.8%20.0%14.6%19.8%19.0%19.7%14.8%12.7%12.7%17.6%17.6%17.6%17.6%17.6%17.6%14.3%8.7%16.5%16.8%15.6%15.3%17.4%9.1%13.5%13.9%11.0%10.5%10.9%10.1%9.8%9.9%9.3%10.0%9.9%10.0%9.6%9.3%8.8%8.2%7.9%7.7%7.6%7.4%7.7%7.9%7.7%7.6%8.3%7.6%7.2%6.9%7.0%6.8%6.9%6.8%6.7%6.4%6.6%6.4%6.8%6.3%6.3%6.5%6.5%4.2%5.9%5.8%5.3%
Kuala Terengganu0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.4%0.3%0.4%0.0%0.0%0.1%0.1%0.1%0.1%0.1%0.1%0.3%0.3%0.4%0.4%0.4%0.4%0.3%0.4%0.3%0.2%0.3%0.3%0.3%0.3%0.3%0.3%0.3%0.3%0.3%0.3%0.3%0.3%0.3%0.3%0.2%0.2%0.3%0.2%0.2%0.2%0.2%0.2%0.3%0.2%0.2%0.2%0.2%0.2%0.3%0.2%0.3%0.3%0.3%0.3%0.3%0.3%0.3%0.2%0.2%0.1%0.2%0.2%0.2%
Kuantan0.0%0.6%1.7%1.9%1.5%1.5%1.1%0.9%1.6%0.8%1.3%0.9%1.0%1.3%1.1%1.1%1.0%1.2%1.9%1.9%1.2%1.2%1.2%1.2%1.2%1.2%1.7%3.1%1.2%1.5%1.3%1.3%1.9%2.3%1.1%1.2%1.2%1.5%2.5%2.6%2.3%2.8%2.6%2.8%2.6%3.0%3.0%3.0%2.8%3.1%3.5%3.3%3.3%3.3%3.1%3.2%3.1%3.1%3.6%3.5%3.5%3.5%3.8%4.5%6.1%6.4%6.5%6.8%7.0%6.9%7.0%6.2%5.9%5.8%3.9%3.6%3.3%3.3%3.4%
Kuching35.7%34.9%23.7%26.2%22.5%23.2%17.5%20.8%15.0%19.1%16.6%20.6%21.6%17.3%17.9%15.1%15.9%16.3%15.6%15.6%17.4%17.4%17.4%17.4%17.4%17.4%15.7%8.2%17.1%15.7%12.8%11.4%8.1%14.2%11.2%10.2%9.2%8.8%9.2%9.2%9.0%8.9%8.9%9.6%9.3%9.0%9.4%8.8%8.4%8.2%7.3%7.5%7.2%7.1%7.2%7.4%7.0%6.9%7.6%7.0%6.8%6.3%6.5%6.5%6.4%6.5%5.9%5.5%5.6%5.6%5.6%5.5%5.6%6.3%6.6%3.8%5.4%5.3%4.9%
Labuan0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.0%0.0%0.1%0.1%0.1%0.1%0.1%0.1%0.0%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.0%0.1%0.1%0.1%
Lahad Datu0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%
Langkawi0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.2%0.4%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.3%0.3%0.3%0.3%0.3%0.4%0.2%0.4%0.4%0.3%0.3%0.4%0.4%0.4%0.5%0.4%0.3%0.3%0.4%0.4%0.4%0.5%0.3%0.3%0.3%0.4%0.4%0.4%0.4%0.3%0.4%0.5%0.4%0.5%0.4%0.5%0.4%0.4%0.6%0.5%0.1%0.3%0.3%0.3%
Melaka5.5%6.4%10.5%9.5%9.7%9.8%8.4%6.7%7.8%4.0%5.9%4.0%3.6%4.1%3.1%3.9%3.5%3.8%7.1%7.1%4.6%4.6%4.6%4.6%4.6%4.6%6.5%4.5%4.1%4.4%4.1%4.1%4.8%4.7%4.2%5.1%4.6%4.6%4.4%4.3%4.6%4.7%4.9%4.7%4.7%4.2%4.3%4.6%4.5%4.7%4.5%4.6%4.4%4.1%4.7%4.4%4.5%4.1%4.1%4.3%4.2%3.9%4.0%4.6%4.6%4.7%5.2%5.1%5.0%5.3%5.6%7.3%5.5%5.3%5.6%7.4%8.7%8.8%9.0%
Miri0.0%0.7%0.4%1.0%0.8%0.6%0.9%1.1%1.3%1.5%1.9%2.9%2.9%2.5%2.9%2.4%1.6%1.7%1.9%1.9%2.2%2.2%2.2%2.2%2.2%2.2%2.1%0.9%2.4%2.2%1.6%1.5%1.1%1.2%1.2%1.1%1.0%0.9%1.0%0.9%0.8%0.8%0.8%0.8%0.9%1.0%1.0%0.9%0.9%0.8%0.9%1.0%0.8%0.8%0.8%0.9%0.8%0.9%1.0%0.8%0.8%0.8%0.9%0.9%0.9%0.9%1.0%0.9%0.9%1.0%1.0%0.9%0.9%1.1%1.1%0.4%0.7%0.7%0.6%
Muar0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.0%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.3%0.2%0.2%0.2%0.3%0.4%0.3%0.3%0.4%0.3%0.4%0.3%0.2%0.3%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.3%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.3%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%
Negeri Sembilan0.2%1.0%1.7%1.6%2.2%2.0%2.6%2.5%2.9%2.5%2.2%1.6%1.8%2.5%2.6%4.2%3.5%3.3%2.5%2.5%2.7%2.7%2.7%2.7%2.7%2.7%3.3%6.7%3.8%4.5%4.7%5.1%5.5%6.0%4.7%4.9%5.0%5.4%5.5%5.2%5.2%5.5%5.2%5.6%5.6%6.3%6.8%6.9%6.7%7.5%7.3%7.1%6.9%7.0%6.9%7.2%7.6%8.4%7.6%7.6%8.0%7.8%8.1%8.0%8.0%8.1%7.6%8.2%7.9%8.8%8.5%8.6%8.9%8.4%8.7%7.1%7.4%7.4%7.5%
Penang18.8%17.5%19.1%18.4%20.4%20.2%16.0%19.1%20.8%15.1%17.4%16.0%16.1%20.6%17.5%16.5%15.8%16.5%22.0%22.0%17.8%17.8%17.8%17.8%17.8%17.8%16.6%20.9%14.1%13.5%15.9%15.7%14.8%15.7%15.6%16.2%17.2%18.1%17.8%18.6%19.4%19.2%20.0%19.7%19.6%19.5%20.4%20.2%21.1%20.7%21.2%21.5%21.7%22.6%22.2%22.4%23.0%22.1%23.2%22.3%22.5%23.8%22.1%21.7%20.6%21.2%21.2%23.1%22.7%22.9%23.6%21.6%22.1%21.7%22.8%25.9%24.3%24.4%24.9%
Sandakan0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.3%0.4%0.7%0.4%0.6%0.6%0.3%0.4%0.3%0.4%0.4%0.3%0.3%0.4%0.4%0.4%0.4%0.4%0.4%0.4%0.2%0.4%0.4%0.4%0.3%0.4%0.2%0.3%0.3%0.2%0.3%0.3%0.3%0.2%0.3%0.2%0.3%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.3%0.3%0.2%0.3%0.2%0.2%0.2%0.3%0.2%0.3%0.2%0.2%0.2%0.3%0.2%0.3%0.2%0.2%0.2%0.2%0.1%0.2%0.2%0.2%
Sibu0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.1%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.2%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.1%0.1%0.2%0.2%0.2%0.1%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.1%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.2%0.1%0.1%0.1%0.1%
Sungai Petani0.0%0.6%1.7%1.2%1.1%1.0%0.8%1.0%1.4%0.4%0.4%0.3%0.3%0.4%0.6%0.7%0.5%0.5%1.3%1.3%0.7%0.7%0.7%0.7%0.7%0.7%1.2%0.5%0.5%0.5%0.5%0.6%0.8%1.3%0.6%0.6%0.6%0.8%1.0%0.9%0.9%0.8%0.8%0.8%0.7%0.5%0.5%0.6%0.4%0.4%0.4%0.3%0.4%0.3%0.4%0.3%0.4%0.3%0.4%0.3%0.3%0.3%0.3%0.3%0.3%0.4%0.5%0.3%0.4%0.4%0.4%0.4%0.4%0.3%0.4%0.4%0.3%0.3%0.3%
Tawau0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.1%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.0%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.1%0.0%0.1%0.1%0.1%
"""

# ---------------------------------
# 1. DATA CLEANING AND PREPARATION
# ---------------------------------

# Read the string data into lines
lines = data_string.strip().split('\n')

# Parse the corrupted header
header_line = lines[0]
# Find all "Mon-Year" patterns. This will find 81 date strings.
header_cols = re.findall(r'([A-Z][a-z]{2}-\d{4})', header_line)

# *** START OF THE FIX ***
# We will parse the FIRST data row to find the *true* number of data columns.
first_data_line = lines[1]
parts = first_data_line.split('%')[:-1]
match = re.match(r'(.+?)(\d+\.\d+)', parts[0])
first_city = match.group(1).strip()
first_val = float(match.group(2))
other_vals = [float(p) for p in parts[1:]]
first_all_vals = [first_val] + other_vals

# This is the "true" number of date columns, which is 79
num_date_cols = len(first_all_vals)

# Now we *truncate* the corrupted header list to match the data count
clean_header_cols = header_cols[:num_date_cols]

# We add the first row we already parsed
parsed_data = []
parsed_data.append([first_city] + first_all_vals)

# Now, loop through the *rest* of the lines
for line in lines[2:]:
    if not line:
        continue
    
    parts = line.split('%')[:-1]
    match = re.match(r'(.+?)(\d+\.\d+)', parts[0])
    city = match.group(1).strip()
    first_val = float(match.group(2))
    other_vals = [float(p) for p in parts[1:]]
    all_vals = [first_val] + other_vals
    
    # Truncate this row's data just in case it's also corrupted
    all_vals_truncated = all_vals[:num_date_cols]
    
    parsed_data.append([city] + all_vals_truncated)
# *** END OF THE FIX ***


# Create the DataFrame
# This will now work:
# Columns = ['City'] + clean_header_cols  (1 + 79 = 80 columns)
# Data    = [city] + all_vals_truncated (1 + 79 = 80 columns)
df = pd.DataFrame(parsed_data, columns=['City'] + clean_header_cols)
df = df.set_index('City')

# *** CRITICAL CLEANING STEP ***
# Drop columns with duplicate names (like 'May-2021'), keeping only the *first* occurrence.
df_cleaned = df.loc[:, ~df.columns.duplicated(keep='first')]

# Convert columns from strings ('Jan-2020') to datetime objects
df_cleaned.columns = pd.to_datetime(df_cleaned.columns, format='%b-%Y')

# Transpose the DataFrame so rows are time and columns are cities
df_ts = df_cleaned.T

# ---------------------------------
# 2. FORECASTING
# ---------------------------------

forecasts = {}
# Define the 12 months of 2026 we want to forecast
forecast_dates = pd.date_range(start='2026-01-01', periods=12, freq='MS')

# Loop over each city column to create a separate forecast
for city in df_ts.columns:
    city_data = df_ts[city]
    
    # For series that are mostly zero, just forecast their mean (~0)
    if city_data.max() < 0.1:
        pred = pd.Series([city_data.mean()] * 12, index=forecast_dates)
    else:
        try:
            # Initialize the ETS (Holt-Winters) model
            model = ExponentialSmoothing(
                city_data, 
                trend='add', 
                seasonal='add', 
                seasonal_periods=12, 
                damped_trend=True
            )
            
            # Fit the model
            fit = model.fit()
            
            # Generate the forecast for the next 12 steps (all of 2026)
            pred = fit.forecast(steps=12)
            
        except Exception as e:
            # Fallback in case the model fails to converge
            print(f"Warning: Model failed for {city}. Using simple mean. Error: {e}")
            pred = pd.Series([city_data.mean()] * 12, index=forecast_dates)

    # Ensure percentages are not forecasted as negative
    pred[pred < 0] = 0
    forecasts[city] = pred

# ---------------------------------
# 3. EXPORT RESULTS TO CSV
# ---------------------------------

# Combine all city forecasts into a single DataFrame
forecast_df = pd.DataFrame(forecasts)

# Transpose back to the original orientation (Cities as rows)
forecast_df_final = forecast_df.T

# Set the column names to the forecasted months
forecast_df_final.columns = forecast_dates.strftime('%b-2026')

# Define the output filename
output_filename = "forecast_2026.csv"

# Export the DataFrame to a CSV file
forecast_df_final.to_csv(output_filename, float_format='%.1f')

print(f"âœ… Successfully exported 2026 forecast to: {output_filename}")

# Optional: Print the DataFrame to the console as well
print("\n--- Forecast Data (as exported) ---")
print(forecast_df_final.round(1))