{
  "kulim_merchant_list": "\n    SELECT \n        merchant_id,\n        merchant_id_nk,\n        merchant_name,\n        district,\n        segment,\n        custom_segment,\n        am_name,\n        is_active,\n        is_bd_account,\n        is_bd_partner\n    FROM ocd_adw.d_merchant\n    WHERE city_id = 13 \n        AND LOWER(district) LIKE '%kulim%'\n        AND is_active = true\n    ORDER BY merchant_name\n    ",
  "kulim_gmv_monthly": "\n    WITH kulim_merchants AS (\n        SELECT DISTINCT merchant_id_nk\n        FROM ocd_adw.d_merchant\n        WHERE city_id = 13 \n            AND LOWER(district) LIKE '%kulim%'\n            AND is_active = true\n    ),\n    monthly_gmv AS (\n        SELECT \n            CAST(SUBSTRING(CAST(f.date_id AS VARCHAR), 1, 6) AS INTEGER) as month_id,\n            COUNT(DISTINCT f.merchant_id) as active_merchants,\n            COUNT(DISTINCT CASE WHEN f.booking_state_simple = 'COMPLETED' THEN f.passenger_id END) as unique_passengers,\n            COUNT(CASE WHEN f.booking_state_simple = 'COMPLETED' THEN 1 END) as completed_orders,\n            SUM(CASE WHEN f.booking_state_simple = 'COMPLETED' THEN f.gross_merchandise_value ELSE 0 END) as total_gmv,\n            AVG(CASE WHEN f.booking_state_simple = 'COMPLETED' THEN f.gross_merchandise_value END) as avg_order_value\n        FROM ocd_adw.f_food_booking f\n        WHERE f.city_id = 13\n            AND f.merchant_id IN (SELECT merchant_id_nk FROM kulim_merchants)\n            AND CAST(SUBSTRING(CAST(f.date_id AS VARCHAR), 1, 6) AS INTEGER) IN (202509, 202510, 202511)\n        GROUP BY CAST(SUBSTRING(CAST(f.date_id AS VARCHAR), 1, 6) AS INTEGER)\n    )\n    SELECT \n        month_id,\n        active_merchants,\n        unique_passengers,\n        completed_orders,\n        total_gmv,\n        avg_order_value,\n        CASE \n            WHEN LAG(total_gmv) OVER (ORDER BY month_id) > 0 \n            THEN ((total_gmv - LAG(total_gmv) OVER (ORDER BY month_id)) / LAG(total_gmv) OVER (ORDER BY month_id)) * 100\n            ELSE NULL\n        END as mom_growth_pct\n    FROM monthly_gmv\n    ORDER BY month_id\n    ",
  "kulim_merchant_performance": "\n    WITH kulim_merchants AS (\n        SELECT DISTINCT merchant_id_nk, merchant_name, segment, custom_segment, am_name\n        FROM ocd_adw.d_merchant\n        WHERE city_id = 13 \n            AND LOWER(district) LIKE '%kulim%'\n            AND is_active = true\n    ),\n    merchant_gmv AS (\n        SELECT \n            f.merchant_id,\n            COUNT(DISTINCT CASE WHEN f.booking_state_simple = 'COMPLETED' THEN f.passenger_id END) as unique_passengers,\n            COUNT(CASE WHEN f.booking_state_simple = 'COMPLETED' THEN 1 END) as completed_orders,\n            SUM(CASE WHEN f.booking_state_simple = 'COMPLETED' THEN f.gross_merchandise_value ELSE 0 END) as total_gmv,\n            AVG(CASE WHEN f.booking_state_simple = 'COMPLETED' THEN f.gross_merchandise_value END) as avg_order_value\n        FROM ocd_adw.f_food_booking f\n        WHERE f.city_id = 13\n            AND f.merchant_id IN (SELECT merchant_id_nk FROM kulim_merchants)\n            AND CAST(SUBSTRING(CAST(f.date_id AS VARCHAR), 1, 6) AS INTEGER) IN (202509, 202510, 202511)\n        GROUP BY f.merchant_id\n    )\n    SELECT \n        m.merchant_id_nk,\n        m.merchant_name,\n        m.segment,\n        m.custom_segment,\n        m.am_name,\n        COALESCE(g.total_gmv, 0) as total_gmv,\n        COALESCE(g.completed_orders, 0) as completed_orders,\n        COALESCE(g.unique_passengers, 0) as unique_passengers,\n        COALESCE(g.avg_order_value, 0) as avg_order_value,\n        CASE \n            WHEN COALESCE(g.total_gmv, 0) > 0 THEN 'Active'\n            ELSE 'Inactive'\n        END as performance_status\n    FROM kulim_merchants m\n    LEFT JOIN merchant_gmv g ON m.merchant_id_nk = g.merchant_id\n    ORDER BY g.total_gmv DESC NULLS LAST\n    LIMIT 50\n    ",
  "kulim_campaign_participation": "\n    WITH kulim_merchants AS (\n        SELECT DISTINCT merchant_id_nk\n        FROM ocd_adw.d_merchant\n        WHERE city_id = 13 \n            AND LOWER(district) LIKE '%kulim%'\n            AND is_active = true\n    ),\n    campaign_data AS (\n        SELECT \n            f.merchant_id,\n            CAST(SUBSTRING(CAST(f.date_id AS VARCHAR), 1, 6) AS INTEGER) as month_id,\n            COUNT(DISTINCT CASE \n                WHEN f.booking_state_simple = 'COMPLETED' \n                AND f.promo_code IS NOT NULL \n                AND f.promo_code != ''\n                THEN f.promo_code \n            END) as unique_campaigns,\n            COUNT(CASE \n                WHEN f.booking_state_simple = 'COMPLETED' \n                AND f.promo_code IS NOT NULL \n                AND f.promo_code != ''\n                THEN 1 \n            END) as campaign_orders,\n            SUM(CASE \n                WHEN f.booking_state_simple = 'COMPLETED' \n                AND f.promo_code IS NOT NULL \n                AND f.promo_code != ''\n                THEN f.gross_merchandise_value \n                ELSE 0 \n            END) as campaign_gmv,\n            COUNT(CASE WHEN f.booking_state_simple = 'COMPLETED' THEN 1 END) as total_orders,\n            SUM(CASE WHEN f.booking_state_simple = 'COMPLETED' THEN f.gross_merchandise_value ELSE 0 END) as total_gmv\n        FROM ocd_adw.f_food_booking f\n        WHERE f.city_id = 13\n            AND f.merchant_id IN (SELECT merchant_id_nk FROM kulim_merchants)\n            AND CAST(SUBSTRING(CAST(f.date_id AS VARCHAR), 1, 6) AS INTEGER) IN (202509, 202510, 202511)\n        GROUP BY f.merchant_id, CAST(SUBSTRING(CAST(f.date_id AS VARCHAR), 1, 6) AS INTEGER)\n    )\n    SELECT \n        month_id,\n        COUNT(DISTINCT merchant_id) as merchants_with_campaigns,\n        SUM(unique_campaigns) as total_unique_campaigns,\n        SUM(campaign_orders) as total_campaign_orders,\n        SUM(campaign_gmv) as total_campaign_gmv,\n        SUM(total_orders) as total_orders,\n        SUM(total_gmv) as total_gmv,\n        CASE \n            WHEN SUM(total_orders) > 0 \n            THEN (SUM(campaign_orders) * 100.0 / SUM(total_orders))\n            ELSE 0\n        END as campaign_participation_rate,\n        CASE \n            WHEN SUM(total_gmv) > 0 \n            THEN (SUM(campaign_gmv) * 100.0 / SUM(total_gmv))\n            ELSE 0\n        END as campaign_gmv_share\n    FROM campaign_data\n    GROUP BY month_id\n    ORDER BY month_id\n    ",
  "kulim_segmentation_analysis": "\n    WITH kulim_merchants AS (\n        SELECT \n            merchant_id_nk,\n            merchant_name,\n            segment,\n            custom_segment,\n            am_name,\n            is_bd_account,\n            is_bd_partner\n        FROM ocd_adw.d_merchant\n        WHERE city_id = 13 \n            AND LOWER(district) LIKE '%kulim%'\n            AND is_active = true\n    ),\n    merchant_gmv AS (\n        SELECT \n            f.merchant_id,\n            SUM(CASE WHEN f.booking_state_simple = 'COMPLETED' THEN f.gross_merchandise_value ELSE 0 END) as total_gmv,\n            COUNT(CASE WHEN f.booking_state_simple = 'COMPLETED' THEN 1 END) as completed_orders\n        FROM ocd_adw.f_food_booking f\n        WHERE f.city_id = 13\n            AND f.merchant_id IN (SELECT merchant_id_nk FROM kulim_merchants)\n            AND CAST(SUBSTRING(CAST(f.date_id AS VARCHAR), 1, 6) AS INTEGER) IN (202509, 202510, 202511)\n        GROUP BY f.merchant_id\n    )\n    SELECT \n        m.segment,\n        m.custom_segment,\n        COUNT(DISTINCT m.merchant_id_nk) as merchant_count,\n        COUNT(DISTINCT CASE WHEN g.total_gmv > 0 THEN m.merchant_id_nk END) as active_merchants,\n        SUM(COALESCE(g.total_gmv, 0)) as total_gmv,\n        SUM(COALESCE(g.completed_orders, 0)) as total_orders,\n        AVG(COALESCE(g.total_gmv, 0)) as avg_merchant_gmv,\n        CASE \n            WHEN COUNT(DISTINCT m.merchant_id_nk) > 0 \n            THEN (COUNT(DISTINCT CASE WHEN g.total_gmv > 0 THEN m.merchant_id_nk END) * 100.0 / COUNT(DISTINCT m.merchant_id_nk))\n            ELSE 0\n        END as activation_rate\n    FROM kulim_merchants m\n    LEFT JOIN merchant_gmv g ON m.merchant_id_nk = g.merchant_id\n    GROUP BY m.segment, m.custom_segment\n    ORDER BY total_gmv DESC\n    ",
  "kulim_t20_analysis": "\n    WITH kulim_merchants AS (\n        SELECT DISTINCT merchant_id_nk, merchant_name, segment, custom_segment, am_name\n        FROM ocd_adw.d_merchant\n        WHERE city_id = 13 \n            AND LOWER(district) LIKE '%kulim%'\n            AND is_active = true\n    ),\n    merchant_gmv AS (\n        SELECT \n            f.merchant_id,\n            SUM(CASE WHEN f.booking_state_simple = 'COMPLETED' THEN f.gross_merchandise_value ELSE 0 END) as total_gmv,\n            COUNT(CASE WHEN f.booking_state_simple = 'COMPLETED' THEN 1 END) as completed_orders\n        FROM ocd_adw.f_food_booking f\n        WHERE f.city_id = 13\n            AND f.merchant_id IN (SELECT merchant_id_nk FROM kulim_merchants)\n            AND CAST(SUBSTRING(CAST(f.date_id AS VARCHAR), 1, 6) AS INTEGER) IN (202509, 202510, 202511)\n        GROUP BY f.merchant_id\n    ),\n    ranked_merchants AS (\n        SELECT \n            m.merchant_id_nk,\n            m.merchant_name,\n            m.segment,\n            m.custom_segment,\n            m.am_name,\n            COALESCE(g.total_gmv, 0) as total_gmv,\n            COALESCE(g.completed_orders, 0) as completed_orders,\n            PERCENT_RANK() OVER (ORDER BY COALESCE(g.total_gmv, 0) DESC) as gmv_percentile\n        FROM kulim_merchants m\n        LEFT JOIN merchant_gmv g ON m.merchant_id_nk = g.merchant_id\n    )\n    SELECT \n        merchant_id_nk,\n        merchant_name,\n        segment,\n        custom_segment,\n        am_name,\n        total_gmv,\n        completed_orders,\n        CASE \n            WHEN gmv_percentile <= 0.20 THEN 'T20'\n            WHEN gmv_percentile <= 0.30 THEN 'T3'\n            ELSE 'Other'\n        END as tier\n    FROM ranked_merchants\n    WHERE gmv_percentile <= 0.30\n    ORDER BY total_gmv DESC\n    "
}